# Simplified Quantum Search for PCR Primers in Maize ADH1 Gene
# Searching for two primer pairs in the ADH1 sequence

print("üî¨ QUANTUM PCR PRIMER SEARCH IN MAIZE ADH1 GENE")
print("="*60)

# Define primer pairs
primer_pairs = {
    "Pair 1": {
        "Fwd": "CGTCGTTTCCCATCTCTTCCTCC",
        "Rev": "GACTGAGGGTCTCGGAGTGG"
    },
    "Pair 2": {
        "Fwd": "TTGGACTAGAAATCTCGTGCTGA",
        "Rev": "GCTACATAGGGAGCCTTGTCCT"
    }
}

# The full ADH1 sequence (first 2000 chars for display, full for search)
adh1_sequence = """GGATCCAAACAGTCACTTAGGATATGTTTGGAAGCACACCGACATGTTTGGAAGCACACAGTTTTAAAAA
ACTATTTTCTATCCTCACTTTCTTGAAAATGTTTTATGAAAAAAATTGGGTGGGGTGTTTGGAACCTAGT
TTCTAGTTTTTTTATAAGGAGAGTAGCTTCTTGGTTTTAGTTAGGAGAGAGTAGCTTCTTGATTTTTAAG
AAACTAAGAATCCAGTTTCTATAAACTGAGACATAAACAAGTATATTTGGAATCACTCTAGTTTGTACAA
ACCAATTTCTTAGAAATTGGATGCTTATAAATAGGCCCTCAATGTCCTTGTTGGGTTTATGAAATTTACA
TCTATTACCATTATTTTAAAAATAGACGAAGAATATGTTAGTAATTATGTATAAAAAACTAGAAACTATT
TTAAAAAAAAACTGAGTTCCAGTTACCTTTATCTAATTCTTTTATTAAGCTAATTTTAGAAACTGAGGAT
AGAAACTGTTTTAAAAAACTGGTGTGCTTCTGTTTTAACTCTTCGTAAGAACAGTGGTACTGCCCGTGTC
TATATTAACTCTTCTGTTTAAAGCCAACATGACATGCTTGCGTGCGGTGAAAATGTGAAATGCCATCGCT
GTGCTACAACTTTTCGGCTCCCTCCTGCTTCGGTGCTTCCATATGCCCCTGCACGGCGTCTAGAAATCCT
AATGGCTGAATACTCAGCAGCACACCTGTCCGCCTAGCCCGCTACGCGTGCACAGAAAACAATTTTTTTG
TCCACACACGCGCGCGCTCCGAGCCGCAGATCCGAGCTAGCGCAGGCGCATCCGACGGCCACGACAGCGT
GCCGTCCTCCGCCGCCACCGCTTAGGCGATTGTCCGCACCCCACCAGTCCACCACCTCCCCCACGAGCGA
AAACCACGTCCACGGACCACGGCTATGTTCCACTCCAGGTGGAGCTGCAGCCCCGGTTTCGCAAGCCGCG
CACGTGGTTTGCTTGCCCACAGGCGGCCAAACCGCACCCTCCTTCCCGTCGTTTCCCATCTCTTCCTCCT
TTAGAGCTACCACTATATAAATCAGGGCTCATTTTCTCGCTCCTCACAGGCTCATCTCGCTTTGGATCGA
TTGGTTTCGTAACTGGTGAAGGACTGAGGGTCTCGGAGTGGATGATTTGGGATTCTGTTCGAAGATTTGC
GGAGGGGGGCAATGGCGACCGCGGGGAAGGTGATCAAGTGCAAAGGTCCGCCTTGTTTCTCCTCTGTCTC
TTGATCTGACTAATCTTGGTTTATGATTCGTTGAGTAATTTTGGGGAAAGCTTCGTCCACAGTTTTTTTT
TCGATGAACAGTGCCGCAGTGGCGCTGATCTTGTATGCTATCCTGCAATCGTGGTGAACTTATGTCTTTT
ATATCCTTCACTACCATGAAAAGACTAGTAATCTTTCTCGATGTAACATCGTCCAGCACTGCTATTACCG
TGTGGTCCATCCGACAGTCTGGCTGAACACATCATACGATATTGAGCAAAGATCTATCTTCCCTGTTCTT
TAATGAAAGACGTCATTTTCATCAGTATGATCTAAGAATGTTGCAACTTGCAAGGAGGCGTTTCTTTCTT
TGAATTTAACTAACTCGTTGAGTGGCCCTGTTTCTCGGACGTAAGGCCTTTGCTGCTCCACACATGTCCA
TTCGAATTTTACCGTGTTTAGCAAGGGCGAAAAGTTTGCATCTTGATGATTTAGCTTGACTATGCGATTG
CTTTCCTGGACCCGTGCAGCTGCGGTGGCATGGGAGGCCGGCAAGCCACTGTCGATCGAGGAGGTGGAGG
TAGCGCCTCCGCAGGCCATGGAGGTGCGCGTCAAGATCCTCTTCACCTCGCTCTGCCACACCGACGTCTA
CTTCTGGGAGGCCAAGGTATCTAATCAGCCATCCCATTTGTGATCTTTGTCAGTAGATATGATACAACAA
CTCGCGGTTGACTTGCGCCTTCTTGGCGGCTTATCTGTCTCAGGGGCAGACTCCCGTGTTCCCTCGGATC
TTTGGCCATGAGGCTGGAGGGTATGTTCTATTCCCCGATTTACTTCACTATGTTGCTGACTATAGATGTG
CTGTGTTTATATTTTACATATTTATTATGTTTTTGCGTCTGAATTTATGGGTATGGTTGGTGGTCTTTGT
TTACTGTTTTACTAGATGCATGTGGAAGAGTCAGAAGAAATAGTTTTTGTTTGAAATGGTATACCAACGG
TTGGATATTATATTATCTGTGTGGACATCAGATGTTCTGGGTTACTGGCAGTGGACTTTGACAGATTTAT
CTATGATTCTTTCATTAGCAGTTTCTTCAGCTAATTTACTCTTACTATTTTTCAGTATACAAAGACACGT
ACAGCTAGGGTTGTGTAGAATCGTTTAAGATCTGTTATATGAGGCAAATTAGCTTATTCTAGCCGCCTGA
AATTTCTTGATTTTGCCAGTATCATAGAGAGTGTTGGAGAGGGTGTGACTGACGTAGCTCCGGGCGACCA
TGTCCTTCCTGTGTTCACTGGGGAGTGCAAGGAGTGCGCCCACTGCAAGTCGGCAGAGAGCAACATGTGT
GATTTGCTCAGGATCAACACTGACCGCGGTGTGATGATTGGCGATGGCAAGTCGCGGTTTTCAATCAATG
GGAAGCCTATCTACCACTTTGTTGGGACTTCCACCTTCAGCGAGTACACCGTCATGCATGTCGGTTGTGT
TGCAAAGATCAACCCTCAGGCTCCCCTTGATAAAGTTTGCGTCCTTAGCTGTGGTATTTCTACTGGTAAG
TTCAATTACTACATTTTGGTGTGGATGCTGGAGTACATTTATCTTGAGATGCTGAGTTACACAAATTCTT
TCTCTGTTTAGGTCTTGGTGCATCAATTAATGTTGCAAAACCTCCGAAGGGTTCGACAGTGGCTGTTTTC
GGTTTAGGAGCCGTTGGTCTTGCCGTAAGTGTTGAAACGATTTGCTTGTTCTATGACATTTCAATTGCAA
TGAGAATGTGTGTTGGGTTTGCATCTGATTACCCTGCGCATGGTTAAGGCTGCAGAAGGTGCAAGGATTG
CTGGAGCGTCAAGGATCATTGGTGTCGACCTGAACCCCAGCAGATTCGAAGAAGGTACAGTACACACACA
TGTATATATGTATGATGTATCCCTTCGATCGAAGGCATGCCTTGGTATAATCACTGAGTAGTCATTTTAT
TACTTTGTTTTGACAAGTCAGTAGTTCATCCATTTGTCCCATTTTTTCAGCTTGGAAGTTTGGTTGCACT
GGCACTTGGTCTAATAACTGAGTAGTCATTTTATTACGTTGTTTCGACAAGTCAGTAGCTCATCCATCTG
TCCCATTTTTTCAGCTAGGAAGTTTGGTTGCACTGGCCTTGGACTAATAACTGATTAGTCATTTTATTAC
ATTGTTTCGACAAGTCAGTAGCTCATCCATCTGTCCCATTTTTCAGCTAGGAAGTTCGGTTGCACTGAAT
TTGTGAACCCAAAAGACCACAACAAGCCGGTGCAGGAGGTCTGTTTCTTTACCCAAGGCAACAAAAGGTT
ATCACAGCTTATGCTGAACTTGGCCATAACATTCAATAATTCCTTTATGGTCTAGGTACTTGCTGAGATG
ACCAACGGAGGGGTCGACCGCAGCGTGGAATGCACTGGCAACATCAATGCTATGATCCAAGCTTTCGAAT
GTGTTCATGATGTAAGTATATGTATACACTCTCAGCTACTTTCATTCTCCAGGTTCCCTTCATCCAGACA
TGCATGTTCTAACCGCCGCCCTCGTGATCCAGGGCTGGGGTGTTGCCGTGCTGGTGGGTGTGCCGCATAA
GGACGCTGAGTTCAAGACCCACCCGATGAACTTCCTGAACGAAAGGACCCTGAAGGGGACCTTCTTTGGC
AACTATAAGCCACGCACTGATCTGCCAAATGTGGTGGAGCTGTACATGAAAAAGGTAAATTGCAAAGTGC
TGTTCCTTCAGTTTCCTTACCTGCCGAGCTTTTGCTGAAAAACTGTTAAGAATCGTTCCTGCAATTCTGC
ACAGGAGCTGGAGGTGGAGAAGTTCATCACGCACAGCGTCCCGTTCGCGGAGATCAACAAGGCGTTCAAC
CTGATGGCCAAGGGGGAGGGCATCCGCTGCATCATCCGCATGGAGAACTAGATTTCGCTGTCTAGTTTGT
GATCTGGCCTGGGCTTGGGGTTAATAAAGGAGGCAATGCTAGCCTGCCCTTTCGATGAGGAGGTACATAC
ACGCTGGCGATGGACCGCGCTTGTGTGTCGCGTTCAGTTTGGCTTTTGCCAAGCAGTAGGGTAGCTTCCC
GTGTCGGTAATTATATGGTATGAACCATCACCTTTTGGCGCAATACATGGTATGAACGTAAGATACAAAT
TCCAACTACCTCTAGCTCGCCGCTATCTGTATCAGTATGTATCTCTCTCGACGGATGACACAAGATCGAA
GAAGCAAATAACTAACTACACCTCGCTCCTATATCCGAAGTGAAACTAAAAGGAGAAGGAAAAGAAGGTA
ACAGAATAGGAACCGGTTTGATGAGAATCGGTTTGATGAGAATTGGAGAGGATTCATGAGAGAGAAAATC
CCTTTCCATTAAATTTTAAATAGCAAGTGAATTACTCTCATGATCTCCTCCAGTTTCCATTTCATCAAAA
CAAACCTTATTCATTTTCCCCTCTAATCTCTTAATTCTCTTGTCACCACCGGGAGCAAGGTGATTAAGGA
GACTAAAACCCTTCATCATTTAATGAATAGTAAGGGTTTTAGCCCTCTCAATTTCTCCAATACCTTGCTC
CCAAATAAATCCCTAAGAGCCGAGGAAGGGGATTAAAAAGGATAAAATCTTCTTTGTGTTCAATTTTGAA
TAGGACTCGCCGTATCGGTAAGGCTTCGCGGCGGGGCTCGCAGTCCGGACTGACGAGGGGGCTATGGAGA
TGGAGAATGACAAGGGGGCTGTTCTGGAAAGTTTCCTTTCCAAGAGTAAGGGTGGTTGGTTTCATACACT
AATTTTTAAGAACGTTTGGTTAAGAAACAGAGAAAAATAGAGTAACTCTATTCTTATTTTATTTTTTGAT
GTTTAGTTTTCAATAAAAAAGAGCACATTTGGAGTTTTCATATAAAAATTTATCATAAATAGTTAAAATG
CTCTCACTCCATAAAAACAATCGGATACTAGCGCTCTCCTTCCTATCCTACCCTCTATGCTCATATTGGC
TCTTCAACCGAAGAGAGAATGGAGGGGCTCCGTTCATTCACTCTTCAACCAAATAAAAAAGGAGCGACTA
TGTTCAGTTTGTCATACGCGGAATAGAACGGCTCTATCCTAAAAAACTAGAATAGAACCCCTCCATTTTA
GTTGACTCTCCAACCAAACGCATAGTCTCTCCATTCCATTCTATTTTAGTCTCTAAATTGACAAATACAT
AAACTAAATTGTATTTTAAGTTTTCGTATTTAATCAATCACTACAAACCAAACACTCCCTAATTTCGCAT
ATCAGCCCCAAATCAAGAGTGGTTGACCCATCGAGACGTTATCGCCGGATCAAAGGCATGCCCCGCTAAG
GCCTAGTTTGGATACTCTTGGATTGAAGTGGTTTGGAGGGATTAGAGGGTATTTAAATCCCCAATAGGTC
AAAAACTCTCACGATACATCTCAATCCACTCCATTCCCTCTTATTCCTAGAGTACCCAAACAAGCCTAAG
GCCTAGTTTGGATACTCTTGGATTGAAGTGGTTTGGAGGGATTAGAGGGTATTTAAATCCCCAATAGGTC
AAAAACTCTCACGATACATCTCAATCCACTCCATTCCCTCTTATTCCTAGAGTACCCAAACAAGCCTAAG
TGTCTAAACTAACGTGCCGTCGAC"""

# Clean the sequence (remove newlines and spaces)
adh1_clean = adh1_sequence.replace('\n', '').replace(' ', '')
print(f"üìä ADH1 Sequence Length: {len(adh1_clean)} nucleotides")
print(f"üìä Database Size: {len(adh1_clean)} elements")

print("\n" + "="*60)
print("üîç SEARCHING FOR PCR PRIMERS USING QUANTUM ALGORITHM")
print("="*60)

# Function to simulate quantum search
import numpy as np

def quantum_search_simulation(target_sequence, database_sequence, primer_name):
    """Simulate quantum search for primer in sequence"""

    # Convert sequences to uppercase
    target = target_sequence.upper()
    database = database_sequence.upper()

    print(f"\nüéØ Searching for: {primer_name}")
    print(f"   Primer sequence: {target}")
    print(f"   Primer length: {len(target)} nucleotides")

    # Classical linear search
    classical_position = database.find(target)
    classical_attempts = len(database) - len(target) + 1 if classical_position == -1 else classical_position + 1

    # Quantum search (theoretical)
    database_size = len(database) - len(target) + 1
    quantum_attempts = int(np.sqrt(database_size))

    # Check if found
    if classical_position != -1:
        print(f"   ‚úÖ FOUND at position: {classical_position + 1}")
        print(f"   üîç Classical search needed: {classical_attempts} comparisons")
        print(f"   ‚öõÔ∏è  Quantum search would need: ~{quantum_attempts} comparisons")
        print(f"   üöÄ Quantum speedup: {classical_attempts/quantum_attempts:.1f}x")

        # Extract context
        start = max(0, classical_position - 20)
        end = min(len(database), classical_position + len(target) + 20)
        context = database[start:end]

        # Highlight primer in context
        if classical_position - start > 0:
            highlighted = context[:classical_position-start] + "[" + target + "]" + context[classical_position-start+len(target):]
        else:
            highlighted = "[" + target + "]" + context[len(target):]

        print(f"   üìç Context: ...{highlighted}...")
    else:
        print(f"   ‚ùå NOT FOUND in sequence")
        print(f"   üîç Classical search needed: {classical_attempts} comparisons")
        print(f"   ‚öõÔ∏è  Quantum search would need: ~{quantum_attempts} comparisons")

    return classical_position, classical_attempts, quantum_attempts

# Search for all primers
results = {}
print("\n" + "="*60)
print("SEARCH RESULTS SUMMARY")
print("="*60)

for pair_name, primers in primer_pairs.items():
    print(f"\nüß¨ {pair_name}:")
    print("-" * 40)

    # Search forward primer
    fwd_pos, fwd_classical, fwd_quantum = quantum_search_simulation(
        primers["Fwd"], adh1_clean, f"Forward Primer ({len(primers['Fwd'])}nt)"
    )

    # Search reverse primer
    rev_pos, rev_classical, rev_quantum = quantum_search_simulation(
        primers["Rev"], adh1_clean, f"Reverse Primer ({len(primers['Rev'])}nt)"
    )

    # Store results
    results[pair_name] = {
        "Fwd": {"position": fwd_pos, "classical": fwd_classical, "quantum": fwd_quantum},
        "Rev": {"position": rev_pos, "classical": rev_classical, "quantum": rev_quantum},
        "Product_size": abs(fwd_pos - rev_pos) + len(primers["Fwd"]) if fwd_pos != -1 and rev_pos != -1 else None
    }

print("\n" + "="*60)
print("üìà QUANTUM VS CLASSICAL PERFORMANCE ANALYSIS")
print("="*60)

# Performance comparison
for pair_name, result in results.items():
    print(f"\n{pair_name}:")
    if result["Fwd"]["position"] != -1 and result["Rev"]["position"] != -1:
        print(f"   ‚úÖ Both primers found!")
        print(f"   üìè Expected PCR product size: {result['Product_size']} bp")

        # Calculate total classical comparisons
        total_classical = result["Fwd"]["classical"] + result["Rev"]["classical"]
        total_quantum = result["Fwd"]["quantum"] + result["Rev"]["quantum"]

        print(f"   üîç Total classical comparisons: {total_classical}")
        print(f"   ‚öõÔ∏è  Total quantum comparisons: ~{total_quantum}")
        print(f"   üöÄ Overall quantum speedup: {total_classical/total_quantum:.1f}x")
    else:
        print(f"   ‚ö†Ô∏è  One or both primers not found")

print("\n" + "="*60)
print("üî¨ SEQUENCE SPECIFIC FINDINGS")
print("="*60)

# Special finding for Pair 1 Forward primer
pair1_fwd_sequence = primer_pairs["Pair 1"]["Fwd"]
pair1_fwd_position = results["Pair 1"]["Fwd"]["position"]

if pair1_fwd_position != -1:
    print(f"\nüéØ INTERESTING FINDING: Pair 1 Forward Primer")
    print(f"   Primer: {pair1_fwd_sequence}")
    print(f"   Found at position: {pair1_fwd_position + 1}")

    # Extract more context around the primer
    context_start = max(0, pair1_fwd_position - 50)
    context_end = min(len(adh1_clean), pair1_fwd_position + len(pair1_fwd_sequence) + 50)
    full_context = adh1_clean[context_start:context_end]

    # Find primer in context
    primer_in_context = adh1_clean[pair1_fwd_position:pair1_fwd_position + len(pair1_fwd_sequence)]
    context_before = adh1_clean[context_start:pair1_fwd_position]
    context_after = adh1_clean[pair1_fwd_position + len(pair1_fwd_sequence):context_end]

    print(f"\n   üìç Extended context (100bp window):")
    print(f"   ...{context_before}[{primer_in_context}]{context_after}...")

    # Check if this is in a coding region (look for start/stop codons nearby)
    print(f"\n   üß™ Sequence analysis:")

    # Look for ATG (start codon) nearby
    upstream_region = adh1_clean[max(0, pair1_fwd_position-100):pair1_fwd_position]
    if "ATG" in upstream_region:
        atg_pos = upstream_region.rfind("ATG")
        distance_to_start = len(upstream_region) - atg_pos
        print(f"   ‚Ä¢ Found ATG (start codon) {distance_to_start}bp upstream")

    # Look for stop codons nearby
    downstream_region = adh1_clean[pair1_fwd_position + len(pair1_fwd_sequence):pair1_fwd_position + len(pair1_fwd_sequence) + 100]
    stop_codons = ["TAA", "TAG", "TGA"]
    for stop in stop_codons:
        if stop in downstream_region:
            stop_pos = downstream_region.find(stop)
            print(f"   ‚Ä¢ Found {stop} (stop codon) {stop_pos}bp downstream")
            break

print("\n" + "="*60)
print("üí° QUANTUM COMPUTING INSIGHTS FOR PCR DESIGN")
print("="*60)

print("""
How quantum computing could enhance PCR primer design:

1. **Multi-target searching**: Quantum computers could search for
   multiple primer pairs simultaneously in superposition

2. **Optimization**: Find optimal primer pairs that minimize
   secondary structure and maximize specificity

3. **Large database screening**: Quickly screen primer specificity
   against entire genomes or metagenomic databases

4. **Mismatch tolerance**: Quantum algorithms can be designed to
   tolerate mismatches (useful for degenerate primers)

5. **Real-time design**: Dynamic primer optimization during
   PCR experiments based on early amplification results

Current limitations:
‚Ä¢ Quantum hardware still limited (100-400 qubits)
‚Ä¢ Classical methods faster for small databases
‚Ä¢ But quantum advantage grows exponentially with database size
""")

print("\n" + "="*60)
print("‚úÖ SEARCH COMPLETE")
print("="*60)
print(f"Database scanned: {len(adh1_clean)} nucleotides")
print(f"Primer pairs searched: {len(primer_pairs)}")
print(f"Total possible primer positions: {len(adh1_clean) * 2}")

# Estimate quantum time savings
total_classical_comparisons = sum(
    result["Fwd"]["classical"] + result["Rev"]["classical"]
    for result in results.values()
)
total_quantum_comparisons = sum(
    result["Fwd"]["quantum"] + result["Rev"]["quantum"]
    for result in results.values()
)

print(f"\nüìä Theoretical Performance:")
print(f"   Total classical operations: {total_classical_comparisons:,}")
print(f"   Total quantum operations: ~{total_quantum_comparisons:,}")
print(f"   Theoretical quantum speedup: {total_classical_comparisons/total_quantum_comparisons:.1f}x")

print("\n" + "="*60)
